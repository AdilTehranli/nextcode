# This is the counterpart to lib/Threading/CMakeLists.txt.  Any updates
# need to be reflected in both places.

add_nextcode_target_library(nextcodeCompatibilityThreading OBJECT_LIBRARY
  "${NEXTCODE_SOURCE_DIR}/lib/Threading/C11.cpp"
  "${NEXTCODE_SOURCE_DIR}/lib/Threading/Linux.cpp"
  "${NEXTCODE_SOURCE_DIR}/lib/Threading/Pthreads.cpp"
  "${NEXTCODE_SOURCE_DIR}/lib/Threading/Win32.cpp"
  INSTALL_IN_COMPONENT never_install
  TARGET_SDKS ${NEXTCODE_DARWIN_PLATFORMS}

  C_COMPILE_FLAGS
    ${CXX_COMPILE_FLAGS}
    "-DNEXTCODE_THREADING_IS_COMPATIBILITY_LIBRARY"
  DEPLOYMENT_VERSION_OSX ${COMPATIBILITY_MINIMUM_DEPLOYMENT_VERSION_OSX}
  DEPLOYMENT_VERSION_IOS ${COMPATIBILITY_MINIMUM_DEPLOYMENT_VERSION_IOS}
  DEPLOYMENT_VERSION_TVOS ${COMPATIBILITY_MINIMUM_DEPLOYMENT_VERSION_TVOS}
  DEPLOYMENT_VERSION_WATCHOS ${COMPATIBILITY_MINIMUM_DEPLOYMENT_VERSION_WATCHOS}
  DEPLOYMENT_VERSION_XROS ${COMPATIBILITY_MINIMUM_DEPLOYMENT_VERSION_XROS}

  MACCATALYST_BUILD_FLAVOR "zippered")
